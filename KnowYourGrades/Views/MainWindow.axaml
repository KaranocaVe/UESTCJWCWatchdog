<sukiUi:SukiWindow xmlns="https://github.com/avaloniaui"
                   xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                   xmlns:vm="using:KnowYourGrades.ViewModels"
                   xmlns:sukiUi="clr-namespace:SukiUI.Controls;assembly=SukiUI"
                   xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                   xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                   xmlns:iconPacks="https://github.com/MahApps/IconPacks.Avalonia"
                   xmlns:objectModel="clr-namespace:System.Collections.ObjectModel;assembly=System.ObjectModel"
                   xmlns:views="clr-namespace:KnowYourGrades.Views"
                   mc:Ignorable="d" d:DesignWidth="1150" d:DesignHeight="600"
                   x:Class="KnowYourGrades.Views.MainWindow"
                   x:DataType="vm:MainWindowViewModel"
                   Icon="/Assets/uestc.ico"
                   Title="KnowYourGrades"
                   Width="1150"
                   Height="600">

    <Design.DataContext>
        <!-- This only sets the DataContext for the previewer in an IDE,
             to set the actual DataContext for runtime, set the DataContext property in code (look at App.axaml.cs) -->
        <vm:MainWindowViewModel />
    </Design.DataContext>

    <sukiUi:SukiWindow.Hosts>
        <sukiUi:GlassCard Margin="40" IsOpaque="True" IsVisible="{Binding IsLoading}">
            <sukiUi:BusyArea BusyText="更新中..." IsBusy="{Binding IsLoading}">
            </sukiUi:BusyArea>
        </sukiUi:GlassCard>
        <sukiUi:SukiToastHost Manager="{Binding ToastManager}" />
    </sukiUi:SukiWindow.Hosts>

    <sukiUi:SukiWindow.Styles>
        <Styles>
            <Style Selector="TextBlock">
                <Setter Property="FontSize" Value="16"></Setter>
                <Setter Property="FontFamily" Value="{StaticResource SourceHanSerifCn}"></Setter>
                <Setter Property="TextWrapping" Value="Wrap"></Setter>
            </Style>
        </Styles>
    </sukiUi:SukiWindow.Styles>

    <sukiUi:SukiSideMenu IsToggleButtonVisible="False">
        <sukiUi:SukiSideMenu.HeaderContent>
            <Grid>
                <Image Source="avares://KnowYourGrades/Assets/jwclogo.png"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Center"
                       Margin="10,0,10,32" />
            </Grid>
        </sukiUi:SukiSideMenu.HeaderContent>
        <sukiUi:SukiSideMenu.FooterContent>
            <StackPanel>
                <TextBlock Text="V3.0" Foreground="Gray" HorizontalAlignment="Center"></TextBlock>
                <iconPacks:PackIconBoxIcons Kind="LogosGithub" HorizontalAlignment="Center" Margin="10" />
                <TextBlock Text="KaranocaVe" Foreground="Gray" HorizontalAlignment="Center"></TextBlock>
            </StackPanel>
        </sukiUi:SukiSideMenu.FooterContent>
        <sukiUi:SukiSideMenu.Items>
            <sukiUi:SukiSideMenuItem Header="总评成绩" Classes="Compact">
                <sukiUi:SukiSideMenuItem.Icon>
                    <iconPacks:PackIconMaterialDesign Kind="Grading" />
                </sukiUi:SukiSideMenuItem.Icon>
                <sukiUi:SukiSideMenuItem.PageContent>
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"></RowDefinition>
                            <RowDefinition Height="Auto"></RowDefinition>
                        </Grid.RowDefinitions>
                        <StackPanel Orientation="Horizontal" Margin="10">
                            <ComboBox PlaceholderText="选择学年"
                                      SelectedValue="{Binding SemesterYear}"
                                      ItemsSource="{Binding AvailableSemesterYear}">
                            </ComboBox>
                            <ComboBox PlaceholderText="选择学期"
                                      SelectedItem="{Binding SemesterNumber}"
                                      ItemsSource="{Binding AvailableSemesterNumber}"
                                      Margin="10,0,10,0">
                            </ComboBox>
                            <Button Command="{Binding ManuallyLoadCoursesFromPythonAsync}">
                                <iconPacks:PackIconMaterialDesign Kind="Cached" />
                            </Button>
                            <TextBlock Text="{Binding LastUpdateTime}" Margin="10,13,10,0" Foreground="Gray" />

                        </StackPanel>

                        <sukiUi:GlassCard Grid.Row="1" Margin="15,0,15,15">
                            <DataGrid AutoGenerateColumns="False"
                                      ItemsSource="{Binding FinalGrades}"
                                      Margin="5,0,5,5" IsReadOnly="True">
                                <DataGrid.Columns>
                                    <!-- <DataGridTextColumn Header="课程代码" Binding="{Binding CourseCode}" Width="120" /> -->
                                    <!-- <DataGridTextColumn Header="课程序号" Binding="{Binding CourseId}" Width="120" /> -->
                                    <DataGridTextColumn Header="课程名称" Binding="{Binding CourseName}" Width="220" />
                                    <DataGridTextColumn Header="课程类别" Binding="{Binding CourseType}" Width="120" />
                                    <DataGridTextColumn Header="学分" Binding="{Binding Credit}" Width="80" />
                                    <DataGridTextColumn Header="期末成绩" Binding="{Binding FinalExamScore}" Width="80" />
                                    <DataGridTextColumn Header="总评成绩" Binding="{Binding OverallScore}" Width="80" />
                                    <DataGridTextColumn Header="补考总评" Binding="{Binding MakeupScore}" Width="80" />
                                    <DataGridTextColumn Header="最终" Binding="{Binding FinalScore}" Width="80" />
                                    <DataGridTextColumn Header="绩点" Binding="{Binding GPA}" Width="80" />
                                </DataGrid.Columns>
                            </DataGrid>
                        </sukiUi:GlassCard>
                    </Grid>
                </sukiUi:SukiSideMenuItem.PageContent>
            </sukiUi:SukiSideMenuItem>
            <sukiUi:SukiSideMenuItem Header="平时成绩" Classes="Compact">
                <sukiUi:SukiSideMenuItem.Icon>
                    <iconPacks:PackIconMaterialDesign Kind="CoPresent" />
                </sukiUi:SukiSideMenuItem.Icon>
                <sukiUi:SukiSideMenuItem.PageContent>
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"></RowDefinition>
                            <RowDefinition Height="Auto"></RowDefinition>
                        </Grid.RowDefinitions>
                        <StackPanel Orientation="Horizontal" Margin="10">
                            <ComboBox PlaceholderText="选择学年"
                                      SelectedValue="{Binding SemesterYear}"
                                      ItemsSource="{Binding AvailableSemesterYear}">
                            </ComboBox>
                            <ComboBox PlaceholderText="选择学期"
                                      SelectedItem="{Binding SemesterNumber}"
                                      ItemsSource="{Binding AvailableSemesterNumber}"
                                      Margin="10,0,10,0">
                            </ComboBox>
                            <Button Command="{Binding ManuallyLoadCoursesFromPythonAsync}">
                                <iconPacks:PackIconMaterialDesign Kind="Cached" />
                            </Button>
                            <TextBlock Text="{Binding LastUpdateTime}" Margin="10,13,10,0" Foreground="Gray" />

                        </StackPanel>

                        <sukiUi:GlassCard Grid.Row="1" Margin="15,0,15,15">
                            <DataGrid AutoGenerateColumns="False"
                                      ItemsSource="{Binding UsualGrades}"
                                      Margin="5,0,5,5" IsReadOnly="True">
                                <DataGrid.Columns>
                                    <!-- <DataGridTextColumn Header="课程代码" Binding="{Binding CourseCode}" Width="120" /> -->
                                    <!-- <DataGridTextColumn Header="课程序号" Binding="{Binding CourseId}" Width="120" /> -->
                                    <DataGridTextColumn Header="课程名称" Binding="{Binding CourseName}" Width="300" />
                                    <DataGridTextColumn Header="课程类别" Binding="{Binding CourseType}" Width="300" />
                                    <DataGridTextColumn Header="学分" Binding="{Binding Credit}" Width="80" />
                                    <DataGridTextColumn Header="平时成绩" Binding="{Binding UsualScore}" Width="80" />
                                </DataGrid.Columns>
                            </DataGrid>
                        </sukiUi:GlassCard>
                    </Grid>
                </sukiUi:SukiSideMenuItem.PageContent>
            </sukiUi:SukiSideMenuItem>
            <sukiUi:SukiSideMenuItem Header="设置" Classes="Compact">
                <sukiUi:SukiSideMenuItem.Icon>
                    <iconPacks:PackIconMaterialDesign Kind="Settings" />
                </sukiUi:SukiSideMenuItem.Icon>
                <sukiUi:SukiSideMenuItem.PageContent>
                    <sukiUi:SettingsLayout>
                        <sukiUi:SettingsLayout.Items>
                            <objectModel:ObservableCollection x:TypeArguments="sukiUi:SettingsLayoutItem">
                                <sukiUi:SettingsLayoutItem Header="统一身份认证">
                                    <sukiUi:SettingsLayoutItem.Content>
                                        <Grid>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"></RowDefinition>
                                                <RowDefinition Height="Auto"></RowDefinition>
                                            </Grid.RowDefinitions>

                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"></ColumnDefinition>
                                                    <ColumnDefinition Width="Auto"></ColumnDefinition>
                                                </Grid.ColumnDefinitions>
                                                <TextBlock Text="学号:" VerticalAlignment="Center" Margin="5" />
                                                <TextBox Grid.Column="1" Text="{Binding StdNum}" Width="200" Margin="5" />
                                            </Grid>

                                            <Grid Grid.Row="1">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"></ColumnDefinition>
                                                    <ColumnDefinition Width="Auto"></ColumnDefinition>
                                                </Grid.ColumnDefinitions>
                                                <TextBlock Text="密码:" VerticalAlignment="Center" Margin="5" />
                                                <TextBox Grid.Column="1" Text="{Binding StdPwd}" Width="200" Margin="5"
                                                         PasswordChar="*" />
                                            </Grid>
                                        </Grid>
                                    </sukiUi:SettingsLayoutItem.Content>
                                </sukiUi:SettingsLayoutItem>

                                <sukiUi:SettingsLayoutItem Header="自动成绩查询">
                                    <sukiUi:SettingsLayoutItem.Content>
                                        <StackPanel>
                                            <CheckBox Content="启用自动查询" Margin="5"
                                                      IsChecked="{Binding EnableAutoUpdate}" />
                                            <!-- <CheckBox Content="查询总评成绩" Margin="5"/> -->
                                            <!-- <CheckBox Content="查询平时成绩" Margin="5"/> -->
                                            <TextBlock Text="查询间隔（分钟）:" Margin="5" />
                                            <NumericUpDown Width="100" Margin="5" Value="{Binding UpdateInterval}" />
                                            <TextBlock Text="执行间隔不宜低于60分钟，否则容易触发风控。" Margin="5" Foreground="Gray" />
                                            <TextBlock Text="自动查询功能需要在后台运行时才能生效，请确保应用程序在后台运行。" Margin="5"
                                                       Foreground="Gray" />
                                            <CheckBox Content="有更新时聚焦窗口" Margin="5"
                                                      IsChecked="{Binding NeedHighlight}" />
                                            <TextBlock Text="查询到新数据时会自动将窗口提到最前，打游戏慎用。" Margin="5"
                                                       Foreground="Gray" />
                                        </StackPanel>
                                    </sukiUi:SettingsLayoutItem.Content>
                                </sukiUi:SettingsLayoutItem>
                            </objectModel:ObservableCollection>
                        </sukiUi:SettingsLayout.Items>
                    </sukiUi:SettingsLayout>
                </sukiUi:SukiSideMenuItem.PageContent>
            </sukiUi:SukiSideMenuItem>
        </sukiUi:SukiSideMenu.Items>
    </sukiUi:SukiSideMenu>
</sukiUi:SukiWindow>